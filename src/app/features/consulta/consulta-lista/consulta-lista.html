<div class="py-6 animate-fade-in">
    <nav class="br-breadcrumb mb-6" aria-label="Breadcrumbs">
      <ul class="crumb-list">
        <li class="crumb">
          <a [routerLink]="['/']" class="home-link">
            <svg width="20" height="23" viewBox="0 0 20 23" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M9.75 8.65625C9.8125 8.59375 9.90625 8.5625 10 8.5625C10.0625 8.5625 10.1562 8.59375 10.2188 8.65625L16 13.375V18.5C16 18.7812 15.75 19 15.5 19H11.9688C11.7188 19 11.4688 18.7812 11.4688 18.5V15.5C11.4688 15.25 11.25 15 10.9688 15H8.96875C8.71875 15 8.46875 15.25 8.46875 15.5V18.5C8.46875 18.7812 8.25 19 8 19H4.5C4.21875 19 4 18.7812 4 18.5V13.4062L9.75 8.65625ZM18.8438 11.875C18.9375 11.9375 19 12.0625 19 12.1562C19 12.25 18.9688 12.3438 18.9062 12.4062L18.0938 13.375C18.0312 13.4688 17.9375 13.5 17.8125 13.5C17.7188 13.5 17.625 13.4688 17.5625 13.4062L10.2188 7.375C10.1562 7.3125 10.0625 7.28125 10 7.28125C9.90625 7.28125 9.8125 7.3125 9.75 7.375L2.40625 13.4062C2.34375 13.4688 2.25 13.5 2.15625 13.5C2.03125 13.5 1.9375 13.4688 1.875 13.375L1.0625 12.4062C1.03125 12.3438 0.96875 12.25 0.96875 12.1562C0.96875 12.0625 1.03125 11.9375 1.125 11.875L9.03125 5.34375C9.28125 5.15625 9.625 5.03125 10 5.03125C10.3438 5.03125 10.6875 5.15625 10.9375 5.34375L13.75 7.65625V5.40625C13.75 5.1875 13.9062 5.03125 14.125 5.03125H15.875C16.0625 5.03125 16.25 5.1875 16.25 5.40625V9.71875L18.8438 11.875Z" fill="#1351B4"/>
            </svg>
          </a>
        </li>
        <li class="crumb">
          <span class="chevron">></span>
          <a href="javascript:void(0)">Dashboard</a>
        </li>
        <li class="crumb active">
          <span class="chevron">></span>
          <span>Consultar detalhes</span>
        </li>
      </ul>
    </nav>
  <h2 class="text-2xl font-bold text-gov-blue-primary mb-6">
    Consulta de Abastecimentos
  </h2>

  <div class="bg-gray-50 p-6 rounded-t-lg border border-gray-200 border-b-0">
    <form class="grid grid-cols-1 md:grid-cols-3 gap-4">

      <!-- UF -->
      <div>
        <label class="block text-sm font-bold text-gray-700 mb-1">
          Estado (UF)
        </label>
        <select
          [formControl]="ufControl"
          class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 shadow-sm"
        >
          <option value="">Todos</option>
          <option *ngFor="let uf of ufs" [value]="uf">
            {{ uf }}
          </option>
        </select>
      </div>

      <!-- Combustível -->
      <div>
        <label class="block text-sm font-bold text-gray-700 mb-1">
          Combustível
        </label>
        <select
          [formControl]="combustivelControl"
          class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 shadow-sm"
        >
          <option value="">Todos</option>
          <option value="Gasolina">Gasolina</option>
          <option value="Etanol">Etanol</option>
          <option value="Diesel">Diesel</option>
        </select>
      </div>

      <!-- Período -->
      <div>
        <label class="block text-sm font-bold text-gray-700 mb-1">
          Período
        </label>
        <div class="flex gap-2">
          <input
            type="date"
            [formControl]="dataInicioControl"
            class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 shadow-sm"
          />
          <input
            type="date"
            [formControl]="dataFimControl"
            class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 shadow-sm"
          />
        </div>
      </div>

    </form>
  </div>



  <div class="overflow-x-auto bg-white rounded-b-lg shadow-sm border border-gray-200">
    <table class="min-w-full divide-y divide-gray-200">
      <thead class="bg-gray-50">
        <tr>
          <th class="px-6 py-3 text-left text-xs font-bold text-gray-500 uppercase">Data</th>
          <th class="px-6 py-3 text-left text-xs font-bold text-gray-500 uppercase">Posto</th>
          <th class="px-6 py-3 text-left text-xs font-bold text-gray-500 uppercase">Cidade/UF</th>
          <th class="px-6 py-3 text-left text-xs font-bold text-gray-500 uppercase">Tipo de Combustível</th>
          <th class="px-6 py-3 text-left text-xs font-bold text-gray-500 uppercase">Valor litro</th>
          <th class="px-6 py-3 text-left text-xs font-bold text-gray-500 uppercase text-right">Total pago (R$)</th>
          <th class="px-6 py-3 text-center text-xs font-bold text-gray-500 uppercase">Ações</th>
        </tr>
      </thead>
      
      <tbody class="divide-y divide-gray-200 bg-white" *ngIf="abastecimentosFiltrados$ | async as lista">
        <tr *ngFor="let item of lista" class="hover:bg-blue-50 transition-colors">
          <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-700">
            {{ item.data | date:'dd/MM/yyyy' }}
          </td>
          <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">
            {{ item.posto }}
          </td>
          <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-600">
            {{ item.cidade }}
          </td>
          <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-600">
            <span class="px-2 py-1 rounded-full text-xs font-bold" 
                  [ngClass]="{
                    'bg-green-100 text-green-800': item.combustivel === 'Etanol', 
                    'bg-blue-100 text-blue-800': item.combustivel === 'Gasolina',
                    'bg-amber-100 text-amber-800': item.combustivel === 'Diesel',
                    'bg-purple-100 text-purple-800': item.combustivel !== 'Etanol' && 
                                           item.combustivel !== 'Gasolina' && 
                                           item.combustivel !== 'Diesel'
                  }">
              {{ item.combustivel }}
            </span>
          </td>
          <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-600">
            {{ item.valorLitro }}
          </td>
          <td class="px-6 py-4 whitespace-nowrap text-sm font-bold text-gov-blue-primary text-right">
            {{ item.totalPago | currency:'BRL' }}
          </td>
          <td class="px-6 py-4 whitespace-nowrap text-sm text-center">
            <button [routerLink]="['/consulta', item.id]"
                     class="text-gov-blue-primary hover:underline font-bold text-xs">
                     DETALHES 
            </button>
          </td>
        </tr>

        <tr *ngIf="lista.length === 0">
          <td colspan="6" class="px-6 py-10 text-center text-gray-500 italic">
            Nenhum abastecimento encontrado para esta busca.
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="mt-6 flex items-center justify-between bg-white px-4 py-3 border border-gray-200 rounded-lg shadow-sm">
    <div class="flex flex-1 justify-between items-center">
      <span class="text-sm text-gray-700">
        Mostrando registros de <b>{{ totalItens > 0 ? (paginaAtual - 1) * itensPorPagina + 1 : 0 }}</b> 
        até <b>{{ (paginaAtual * itensPorPagina) > totalItens ? totalItens : (paginaAtual * itensPorPagina) }}</b> 
        de um total de <b>{{ totalItens }}</b>
      </span>
      
      <div class="inline-flex rounded-md shadow-sm">
        <button 
          (click)="mudarPagina(-1)"
          [disabled]="paginaAtual === 1"
          class="px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-l-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"
        >
          Anterior
        </button>
        <div class="px-4 py-2 text-sm font-bold text-gov-blue-primary bg-gray-50 border-t border-b border-gray-300">
          {{ paginaAtual }}
        </div>
        <button 
          (click)="mudarPagina(1)"
          [disabled]="paginaAtual >= totalItens / itensPorPagina"
          class="px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-r-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"
        >
          Próximo
        </button>
      </div>
    </div>
  </div>
</div>